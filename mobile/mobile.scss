// Grid layout for mobile: stacked layout
.topic-cards-list--grid {
  .topic-list-body {
    gap: var(--space-4);
  }
}

// List layout for mobile: row layout adapted for mobile
.topic-cards-list--list {
  .topic-list-body {
    gap: var(--space-3);
  }
}

.topic-card--grid {
  flex-direction: column;
  max-height: none;
  max-width: none;
  padding: 0;
  gap: 0;

  &:has(.topic-card__thumbnail) {
    max-height: unset;
  }

  .pull-left,
  .topic-item-stats,
  .topic-item-metadata {
    display: none !important;
  }

  .topic-list-data {
    max-width: none;
  }

  .topic-card__thumbnail {
    text-align: center;
    margin-bottom: var(--space-3);

    .main-thumbnail {
      display: block;
      width: 100%;
      height: auto;
      max-height: #{$grid-thumbnail-max-height}px;
      object-fit: cover;

      // Grid: thumbnail on top, round top corners only
      border-top-left-radius: var(--topic-cards-border-radius);
      border-top-right-radius: var(--topic-cards-border-radius);
      background: var(--primary-low);
    }

    .thumbnail-placeholder {
      display: block;
      width: 100%;
      aspect-ratio: 16 / 9;
      max-height: #{$grid-thumbnail-max-height}px;
      border-top-left-radius: var(--topic-cards-border-radius);
      border-top-right-radius: var(--topic-cards-border-radius);
    }
  }

  &__tags {
    display: block;
    width: 100%;
    box-sizing: border-box;
    margin: 0 0 var(--space-2);
    padding: 0 var(--space-2);
  }

  .main-link {
    display: grid;
    grid-template-areas:
      "tags tags"
      "title title"
      "excerpt excerpt"
      "op op"
      "metadata metadata";
    grid-template-rows: auto auto auto 1fr auto;
    width: 100%;
    padding: var(--space-3) var(--space-5) !important;
    gap: var(--space-2) 0;

    &:first-child {
      grid-template-columns: auto 1fr;
    }

    .link-top-line {
      grid-area: title;
    }

    .link-bottom-line {
      display: none !important; // avoid duplicate tags/meta on mobile
    }
  }
}

// List layout for mobile: row layout with compact spacing
.topic-card--list {
  flex-direction: row;
  max-height: none;
  padding: var(--space-2);
  gap: var(--space-3);

  &:has(.topic-card__thumbnail) {
    max-height: unset;
  }

  .pull-left,
  .topic-item-stats,
  .topic-item-metadata {
    display: none !important;
  }

  .topic-list-data {
    max-width: none;
  }

  .topic-card__thumbnail {
    flex: 0 0 35%;
    max-width: 150px;
    text-align: left;
    margin-bottom: 0;

    .main-thumbnail {
      display: block;
      width: 100%;
      height: 100%;
      max-height: 120px;
      object-fit: cover;

      // List: thumbnail on left, round left corners only
      border-top-left-radius: var(--topic-cards-border-radius);
      border-bottom-left-radius: var(--topic-cards-border-radius);
      background: var(--primary-low);
    }

    .thumbnail-placeholder {
      display: block;
      width: 100%;
      height: 100%;
      max-height: 120px;
      aspect-ratio: 16 / 9;
      border-top-left-radius: var(--topic-cards-border-radius);
      border-bottom-left-radius: var(--topic-cards-border-radius);
    }
  }

  &__tags {
    display: block;
    width: 100%;
    box-sizing: border-box;
    margin: 0 0 var(--space-1);
    padding: 0;
  }

  .main-link {
    display: grid;
    grid-template-areas:
      "tags tags"
      "title title"
      "excerpt excerpt"
      "op op"
      "metadata metadata";
    grid-template-rows: auto auto 1fr auto auto;
    width: 100%;
    padding: 0 !important;
    gap: var(--space-1) 0;

    &:first-child {
      grid-template-columns: auto 1fr;
    }

    .link-top-line {
      grid-area: title;
      font-size: var(--font-down-1);
    }

    .link-bottom-line {
      display: none !important;
    }
  }

  .topic-card__excerpt {
    font-size: var(--font-down-1);
  }

  .topic-card__metadata {
    font-size: var(--font-down-2);
  }

  .topic-card__op {
    font-size: var(--font-down-2);
  }
}

// Overflow safety tweaks for mobile
.topic-card {
  // Ensure grid area can shrink inside the flex card
  .main-link { min-width: 0; }

  .topic-card__metadata {
    min-width: 0;

    // Allow action items to wrap on narrow screens instead of overflowing
    .right-aligned {
      flex-wrap: wrap;
      gap: var(--space-2);
      min-width: 0;
    }

    .item {
      flex: 0 1 auto;
      min-width: 0;
    }
  }

  // Extra safety for very long words/URLs
  .title,
  .topic-card__excerpt-text {
    word-break: break-word;
    overflow-wrap: anywhere;
  }
}

